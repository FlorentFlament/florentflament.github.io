<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#">
<head>
  <meta charset="UTF-8" />
  <title>Right VM cost | Florent Flament 2 cents</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="http://www.florentflament.com/static/m-dark.css" />
  <link rel="canonical" href="http://www.florentflament.com/blog/right-vm-cost.html" />
  <link href="http://www.florentflament.com/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Florent Flament 2 cents" />
  <link href="http://www.florentflament.com/blog/feeds/misc.atom.xml" type="application/atom+xml" rel="alternate" title="Florent Flament 2 cents | misc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
  <meta property="og:site_name" content="Florent Flament 2 cents" />
  <meta property="og:title" content="Right VM cost" />
  <meta name="twitter:title" content="Right VM cost" />
  <meta property="og:url" content="http://www.florentflament.com/blog/right-vm-cost.html" />
  <meta property="og:description" content="With cloud Virtual Machines prices dropping month after month, we may be asking if the margins previously done by cloud operators were not outrageously high. I actually find surprising that current VM price is on average higher than equivalent dedicated server even though virtualization allows sharing more hardware. Comparing dedicated …" />
  <meta name="twitter:description" content="With cloud Virtual Machines prices dropping month after month, we may be asking if the margins previously done by cloud operators were not outrageously high. I actually find surprising that current VM price is on average higher than equivalent dedicated server even though virtualization allows sharing more hardware. Comparing dedicated …" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:type" content="article" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="http://www.florentflament.com/blog/" id="m-navbar-brand" class="m-col-t-9 m-col-m-none m-left-m">Florent Flament 2 cents</a>
    </div>
  </div>
</nav></header>
<main>
<div class="m-container">
  <div class="m-row">
    <article class="m-col-m-10 m-nopadb">
      <header>
        <h1><a href="http://www.florentflament.com/blog/right-vm-cost.html" rel="bookmark" title="Permalink to Right VM cost">
          <time class="m-date" datetime="2014-08-03T00:00:00+02:00">
            Aug <span class="m-date-day">03</span> 2014
          </time>
          Right VM cost
        </a></h1>
        <p>With cloud Virtual Machines prices dropping month after month, we may
        be asking if the margins previously done by cloud operators were not
        outrageously high. I actually find surprising that current VM price is
        on average higher than equivalent dedicated server even though
        virtualization allows sharing more hardware.</p>
        <h2>Comparing dedicated …</h2>
      </header>
      <div class="m-clearfix-l"></div>
<!-- content -->
<p>With cloud Virtual Machines prices dropping month after month, we may
be asking if the margins previously done by cloud operators were not
outrageously high. I actually find surprising that current VM price is
on average higher than equivalent dedicated server even though
virtualization allows sharing more hardware.</p>
<h2>Comparing dedicated server versus VM costs</h2>
<p>Low cost dedicated servers:</p>
<ul>
<li>CPU 1 Core / 2 threads - RAM 2 GB - HDD 500 GB - costs €5 / month at <a href="http://www.kimsufi.com/en/">Kimsufi</a></li>
<li>CPU 1 Core - RAM 2 GB - SHDD 500 GB - costs €9.99 / month at <a href="http://www.online.net/en/dedicated-server">online</a></li>
</ul>
<p>Low cost VMs:</p>
<ul>
<li>CPU 2 Cores - RAM 2 GB - SSD 40 GB - costs $20 / month at <a href="https://www.digitalocean.com/pricing/">DigitalOcean</a></li>
<li>vCPUs 2 - RAM 2 GB - SSD 60 GB - $54 / month at <a href="http://www.rackspace.com/cloud/public-pricing/">rackspace</a></li>
<li>vCPUs 1 (fractional) - RAM 2 GB - 0 (additional storage cost) - $19 / month at <a href="http://aws.amazon.com/ec2/pricing/">Amazon</a></li>
</ul>
<p>Virtual machines CPUs don't have much meaning, since depending on the
underlying hardware a virtual machine CPU may correspond to a physical
CPU core, thread or a fraction of CPU if the hypervisor is sharing
CPUs among VMs. Amazon introduces an EC2 Compute Unit (ECU), that
would allow objectively <a href="http://aws.amazon.com/ec2/faqs/">comparing CPU performance between VMs</a>.</p>
<p>At first glance we can see that for low end configurations the
price/performance ratio of Virtual Machines looks much higher than
ratio of dedicated servers.</p>
<h2>Estimating cost of hardware</h2>
<p>We can make an estimate of the cost of hardware by performing a
<a href="http://en.wikipedia.org/wiki/Regression_analysis">multiple regression analysis</a> on dedicated server prices.</p>
<p><a href="http://www.ovh.com/fr/serveurs_dedies/enterprise/">OVH prices</a> (only considering Intel Xeon CPUs):</p>
<div class="highlight"><pre><span></span>|-------------------------------------------------------------------------------------------|
|         CPU type        | # threads | RAM (GB) | HDD (TB) | SSD (GB) | Price (€/month HT) |
|-------------------------------------------------------------------------------------------|
|                                 OVH Enterprise                                            |
|-------------------------------------------------------------------------------------------|
| Intel Xeon E5-1620v2    |     8     |    64    |     4    |     0    |       €81.99       |
| Intel Xeon E5-1650v2    |    12     |   128    |     4    |     0    |      €131.99       |
| Intel Xeon 2x E5-2650v2 |    32     |   128    |     4    |     0    |      €202.99       |
| Intel Xeon 2x E5-2670v2 |    40     |   256    |     4    |     0    |      €302.99       |
|-------------------------------------------------------------------------------------------|
|                                   OVH Infra                                               |
|-------------------------------------------------------------------------------------------|
| Intel Xeon E5-1620v2    |     8     |    32    |     6    |     0    |       €81.99       |
| Intel Xeon E5-1650v2    |    12     |    64    |     6    |     0    |      €141.99       |
| Intel Xeon 1x E5-2650v2 |    16     |   128    |     6    |     0    |      €191.99       |
| Intel Xeon 2x E5-2650v2 |    32     |   128    |     6    |     0    |      €302.99       |
| Intel Xeon 2x E5-2670v2 |    40     |   256    |     6    |     0    |      €402.99       |
|-------------------------------------------------------------------------------------------|
|                                   OVH Storage                                             |
|-------------------------------------------------------------------------------------------|
| Intel Xeon 1x E5 2620v2 |    12     |    48    |    48    |     0    |      €372.99       |
| Intel Xeon 1x E5 2620v2 |    12     |    48    |    72    |     0    |      €522.00       |
| Intel Xeon 2x E5 2620v2 |    24     |    64    |   144    |     0    |      €822.00       |
| Intel Xeon 2x E5 2620v2 |    24     |    64    |   216    |     0    |     €1272.00       |
| Intel Xeon 1x E5 2620v2 |    12     |    48    |    36    |   360    |      €372.99       |
| Intel Xeon 1x E5 2620v2 |    12     |    48    |    54    |   360    |      €522.00       |
| Intel Xeon 2x E5 2620v2 |    24     |    64    |   108    |  1080    |      €822.00       |
| Intel Xeon 2x E5 2620v2 |    24     |    64    |   162    |  1080    |     €1272.00       |
|-------------------------------------------------------------------------------------------|
</pre></div>


<p>In our case, for each server setting we have:
Yi = ß1 + ß2<em>Xi2 + ß3</em>Xi3 + ß4<em>Xi4 + ß5</em>Xi5 + Ei
where:</p>
<ul>
<li>Yi is the price for setting i</li>
<li>ß1 is a constant per server</li>
<li>ß2 is the estimate of € / thread</li>
<li>ß3 is the estimate of € / GB of RAM</li>
<li>ß4 is the estimate of € / TB of HDD</li>
<li>ß5 is the estimate of € / GB of SSD</li>
<li>Xi2 is the number of CPU threads for setting i</li>
<li>Xi3 is the amount of RAM in GB for setting i</li>
<li>Xi4 is the amount of HDD space in TB for setting i</li>
<li>Xi5 is the amount of SSD space in GB for setting i</li>
<li>Ri is the residual error for setting i</li>
</ul>
<p>We can estimate ßj coefficients with the following formula:
ß = (Xt<em>X)-¹</em>Xt*Y</p>
<div class="highlight"><pre><span></span>$ python pricing_vm_simple.py
Constant: <span class="m">31</span>.3530724158
Eur / CPU thread: <span class="m">3</span>.12689639938
Eur / GB of RAM: <span class="m">0</span>.639580183605
Eur / TB of HDD: <span class="m">5</span>.18992626031
Eur / GB of SSD: <span class="m">0</span>.197627042107
R^2: <span class="m">0</span>.982339781679
</pre></div>


<p>Assuming that we rent some of the afore mentioned dedicated servers,
what comes out from these results is that the most expensive resource
is the Intel Xeon CPU thread, which costs more than €3/month. Hence
the monthly cost of the following configurations (including €1 share
of server fixed cost):</p>
<ul>
<li>2 Full Xeon Threads - 2 GB RAM - 40 GB SSD : €16.50</li>
<li>1 Full Xeon Thread - 1 GB RAM - 10 GB SSD : €6.75</li>
<li>1/4th Xeon Thread - 1 GB RAM - 5 GB SSD : €3.40</li>
<li>1/8th Xeon Thread - 512 MB RAM - 1 GB SSD : €1.90</li>
</ul>
<h2>Interpretation</h2>
<p>These hardware costs look rather aligned with cheapest (Digital Ocean)
VMs prices. On the other hand, public cloud leaders (Rackspace and
Amazon) are much more expensive.</p>
<p>So should Virtual Machines be cheaper than equivalent dedicated
servers ? Well, this is possible when virtualization allows sharing a
certain amount of fixed costs among users of the same hardware.
According to the previous regression analysis (and hardware
considered), these fixed costs account for roughly €30 / month per
server. Therefore, for low end VMs from some Euros to tens of Euros,
fixed costs sharing looks meaningful. On the other hand, high end VMs
are costly and don't allow many users to share the same server. In
that case, there is no real cost advantage in choosing a VM instead of
a dedicated server in a 24H / 24 7D / 7 usage scenario. However, for
ephemeral usage, high end virtual machines may make sense. Besides,
SSD storage (which is recommended when sharing a disk with many users)
is costly. Therefore, in the case of huge storage space requirements,
dedicated servers with big HDDs may be more appropriate.</p>
<h2>Annex - Regression Analysis code</h2>
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span>
<span class="s1">&#39;1,  8,  64,   4,    0;&#39;</span>
<span class="s1">&#39;1, 12, 128,   4,    0;&#39;</span>
<span class="s1">&#39;1, 32, 128,   4,    0;&#39;</span>
<span class="s1">&#39;1, 40, 256,   4,    0;&#39;</span>
<span class="s1">&#39;1,  8,  32,   6,    0;&#39;</span>
<span class="s1">&#39;1, 12,  64,   6,    0;&#39;</span>
<span class="s1">&#39;1, 16, 128,   6,    0;&#39;</span>
<span class="s1">&#39;1, 32, 128,   6,    0;&#39;</span>
<span class="s1">&#39;1, 40, 256,   6,    0;&#39;</span>
<span class="s1">&#39;1, 12,  48,  48,    0;&#39;</span>
<span class="s1">&#39;1, 12,  48,  72,    0;&#39;</span>
<span class="s1">&#39;1, 24,  64, 144,    0;&#39;</span>
<span class="s1">&#39;1, 24,  64, 216,    0;&#39;</span>
<span class="s1">&#39;1, 12,  48,  36,  360;&#39;</span>
<span class="s1">&#39;1, 12,  48,  54,  360;&#39;</span>
<span class="s1">&#39;1, 24,  64, 108, 1080;&#39;</span>
<span class="s1">&#39;1, 24,  64, 162, 1080&#39;</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span>
<span class="s1">&#39;  81.99;&#39;</span>
<span class="s1">&#39; 131.99;&#39;</span>
<span class="s1">&#39; 202.99;&#39;</span>
<span class="s1">&#39; 302.99;&#39;</span>
<span class="s1">&#39;  81.99;&#39;</span>
<span class="s1">&#39; 141.99;&#39;</span>
<span class="s1">&#39; 191.99;&#39;</span>
<span class="s1">&#39; 302.99;&#39;</span>
<span class="s1">&#39; 402.99;&#39;</span>
<span class="s1">&#39; 372.99;&#39;</span>
<span class="s1">&#39; 522.00;&#39;</span>
<span class="s1">&#39; 822.00;&#39;</span>
<span class="s1">&#39;1272.00;&#39;</span>
<span class="s1">&#39; 372.99;&#39;</span>
<span class="s1">&#39; 522.00;&#39;</span>
<span class="s1">&#39; 822.00;&#39;</span>
<span class="s1">&#39;1272.00&#39;</span><span class="p">)</span>

<span class="c1"># Computing model parameters</span>
<span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">I</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">Y</span>

<span class="c1"># Computing predictions based on models</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">B</span>

<span class="c1"># Computing R^2</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">SStot</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">Y</span><span class="o">-</span><span class="n">M</span><span class="p">,</span> <span class="n">Y</span><span class="o">-</span><span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">SSres</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">Y</span><span class="o">-</span><span class="n">F</span><span class="p">,</span> <span class="n">Y</span><span class="o">-</span><span class="n">F</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">Rsq</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">SSres</span> <span class="o">/</span> <span class="n">SStot</span>

<span class="nb">print</span> <span class="s2">&quot;Constant:&quot;</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Eur / CPU thread:&quot;</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Eur / GB of RAM:&quot;</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Eur / TB of HDD:&quot;</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Eur / GB of SSD:&quot;</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;R^2:&quot;</span><span class="p">,</span> <span class="n">Rsq</span>
</pre></div>
<!-- /content -->
      <footer>
        <p>Posted by <a href="http://www.florentflament.com/blog/author/florent-flament.html">Florent Flament</a> on <time datetime="2014-08-03T00:00:00+02:00">Sun 03 August 2014</time> in <a href="http://www.florentflament.com/blog/category/misc.html">misc</a>. Tags: <a href="http://www.florentflament.com/blog/tag/virtualization.html">Virtualization</a>, <a href="http://www.florentflament.com/blog/tag/vm.html">VM</a>, <a href="http://www.florentflament.com/blog/tag/hardware.html">Hardware</a>, <a href="http://www.florentflament.com/blog/tag/costs.html">Costs</a>.</p>
      </footer>
    </article>
    <nav class="m-navpanel m-col-m-2">
      <h3>Categories</h3>
      <ol class="m-block-bar-m">
        <li><a href="http://www.florentflament.com/blog/category/misc.html">misc</a></li>
        <li><a href="http://www.florentflament.com/blog/category/openstack.html">OpenStack</a></li>
      </ol>
      <h3>Tag cloud</h3>
      <ul class="m-tagcloud">
        <li class="m-tag-2"><a href="http://www.florentflament.com/blog/tag/amd.html">AMD</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/apple.html">Apple</a></li>
        <li class="m-tag-3"><a href="http://www.florentflament.com/blog/tag/arduino.html">Arduino</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/atmega.html">ATmega</a></li>
        <li class="m-tag-3"><a href="http://www.florentflament.com/blog/tag/ay-3-8910.html">AY-3-8910</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/benchmark.html">Benchmark</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/bug.html">bug</a></li>
        <li class="m-tag-2"><a href="http://www.florentflament.com/blog/tag/ceph.html">Ceph</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/chef.html">Chef</a></li>
        <li class="m-tag-2"><a href="http://www.florentflament.com/blog/tag/cinder.html">Cinder</a></li>
        <li class="m-tag-2"><a href="http://www.florentflament.com/blog/tag/costs.html">Costs</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/cryptocurrency.html">Cryptocurrency</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/data-management.html">Data management</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/data-safety.html">Data Safety</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/data-security.html">Data Security</a></li>
        <li class="m-tag-2"><a href="http://www.florentflament.com/blog/tag/docker.html">Docker</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/documentation.html">Documentation</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/gf7050t-m5.html">GF7050T-M5</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/git.html">Git</a></li>
        <li class="m-tag-2"><a href="http://www.florentflament.com/blog/tag/gpu.html">GPU</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/hardware.html">Hardware</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/irc.html">IRC</a></li>
        <li class="m-tag-2"><a href="http://www.florentflament.com/blog/tag/kernel.html">Kernel</a></li>
        <li class="m-tag-2"><a href="http://www.florentflament.com/blog/tag/keystone.html">Keystone</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/kvm.html">KVM</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/libvirt.html">libvirt</a></li>
        <li class="m-tag-3"><a href="http://www.florentflament.com/blog/tag/linux.html">Linux</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/microsft.html">Microsft</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/old-hardware.html">Old Hardware</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/opencl.html">OpenCL</a></li>
        <li class="m-tag-5"><a href="http://www.florentflament.com/blog/tag/openstack.html">OpenStack</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/operations.html">operations</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/policies.html">Policies</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/printers.html">Printers</a></li>
        <li class="m-tag-2"><a href="http://www.florentflament.com/blog/tag/radeon.html">Radeon</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/raspberry-pi.html">Raspberry Pi</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/raspbian.html">Raspbian</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/ring.html">Ring</a></li>
        <li class="m-tag-2"><a href="http://www.florentflament.com/blog/tag/rx-480.html">RX 480</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/sndh.html">SNDH</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/ssh.html">SSH</a></li>
        <li class="m-tag-2"><a href="http://www.florentflament.com/blog/tag/swift.html">Swift</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/ubuntu.html">Ubuntu</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/virtualization.html">Virtualization</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/vm.html">VM</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/windows.html">Windows</a></li>
        <li class="m-tag-3"><a href="http://www.florentflament.com/blog/tag/ym2149.html">YM2149</a></li>
        <li class="m-tag-3"><a href="http://www.florentflament.com/blog/tag/ym2149f.html">YM2149F</a></li>
        <li class="m-tag-1"><a href="http://www.florentflament.com/blog/tag/znc.html">ZNC</a></li>
      </ul>
    </nav>
  </div>
</div>
</main>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Florent Flament 2 cents. Powered by <a href="https://getpelican.com">Pelican</a> and <a href="https://mcss.mosra.cz">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>